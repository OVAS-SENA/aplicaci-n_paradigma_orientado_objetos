<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Mental: Ecosistema Python</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            background-color: #f8fafc;
            /* slate-50 */
        }

        .node circle {
            cursor: pointer;
            stroke-width: 2px;
        }

        .node text {
            font-size: 12px;
            font-weight: 600;
            paint-order: stroke;
            stroke: #f8fafc;
            stroke-width: 3px;
            stroke-linecap: butt;
            stroke-linejoin: miter;
        }

        .link {
            fill: none;
            stroke: #94a3b8;
            /* slate-400 */
            stroke-opacity: 0.6;
            stroke-width: 2px;
        }

        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            z-index: 10;
        }

        .tooltip {
            position: absolute;
            text-align: center;
            width: auto;
            height: auto;
            padding: 8px;
            font: 12px sans-serif;
            background: #1e293b;
            /* slate-800 */
            color: white;
            border: 0px;
            border-radius: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }
    </style>
</head>

<body class="bg-slate-50">
    <div id="mindmap-container" class="w-full h-screen"></div>
    <div class="tooltip"></div>

    <div class="controls flex flex-col space-y-2">
        <h3 class="text-lg font-bold text-slate-700">Controles</h3>
        <div class="flex items-center space-x-2">
            <button id="zoom_in"
                class="px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">+</button>
            <button id="zoom_out"
                class="px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">-</button>
            <button id="reset"
                class="px-3 py-1 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors">Centrar</button>
        </div>
        <div class="flex items-center space-x-2">
            <label for="spacing" class="text-sm font-medium text-slate-600">Espaciado:</label>
            <input type="range" id="spacing" min="0.5" max="3" step="0.1" value="1.5" class="w-24">
        </div>
    </div>

    <div class="absolute bottom-4 left-4 bg-white p-3 rounded-lg shadow-lg max-w-sm">
        <h2 class="text-xl font-bold text-slate-800 mb-2">Mapa Mental del Ecosistema Python</h2>
        <p class="text-sm text-slate-600">Un resumen visual de las herramientas y conceptos clave. Haz clic en los
            c칤rculos para expandir o contraer las ramas.</p>
    </div>


    <script>
        // --- 1. DATA STRUCTURE ---
        // This JSON object represents the hierarchical structure of the mind map.
        const treeData = {
            "name": "游냀 Ecosistema Python",
            "description": "El conjunto de herramientas para el desarrollo en Python.",
            "children": [
                {
                    "name": "Fundamentos",
                    "description": "Las bases del lenguaje y su ejecuci칩n.",
                    "children": [
                        {
                            "name": "Int칠rpretes",
                            "description": "Implementaciones del lenguaje Python.",
                            "children": [
                                { "name": "CPython", "description": "El est치ndar. Escrito en C. Usa el GIL (Global Interpreter Lock)." },
                                { "name": "PyPy", "description": "R치pido. Usa un compilador JIT (Just-In-Time)." },
                                { "name": "Jython", "description": "Integraci칩n con Java. Corre en la JVM." },
                                { "name": "Cython", "description": "Compilador a C para m치xima velocidad. Superconjunto de Python." }
                            ]
                        },
                        {
                            "name": "Versionado",
                            "description": "Ciclo de vida y soporte de las versiones de Python.",
                            "children": [
                                { "name": "Mantenimiento Activo", "description": "Recibe correcciones de errores y seguridad." },
                                { "name": "Soporte de Seguridad", "description": "Solo recibe parches de seguridad cr칤ticos." },
                                { "name": "Fin de Vida (EOL)", "description": "Obsoleto y sin soporte. Representa un riesgo." }
                            ]
                        }
                    ]
                },
                {
                    "name": "Entornos de Desarrollo",
                    "description": "Herramientas para escribir, depurar y ejecutar c칩digo.",
                    "children": [
                        {
                            "name": "IDEs/Editores",
                            "description": "Entornos de Desarrollo Integrado y editores de c칩digo.",
                            "children": [
                                { "name": "VS Code", "description": "Ligero, modular y extensible. Ideal para desarrollo pol칤glota." },
                                { "name": "PyCharm", "description": "IDE 'todo en uno' especializado en Python. Muy potente." }
                            ]
                        },
                        {
                            "name": "Ciencia de Datos",
                            "description": "Plataformas para an치lisis interactivo y computaci칩n cient칤fica.",
                            "children": [
                                { "name": "Jupyter (Lab/Notebook)", "description": "Entorno interactivo basado en celdas de c칩digo y texto." },
                                { "name": "Anaconda", "description": "Distribuci칩n con paquetes cient칤ficos preinstalados. Usa 'conda'." }
                            ]
                        },
                        {
                            "name": "Desarrollo en la Nube",
                            "description": "Plataformas de desarrollo basadas en la web.",
                            "children": [
                                { "name": "Google Colab", "description": "Jupyter Notebooks en la nube con acceso gratuito a GPUs/TPUs." }
                            ]
                        }
                    ]
                },
                {
                    "name": "Gesti칩n de Dependencias",
                    "description": "Asegurar aislamiento y reproducibilidad en los proyectos.",
                    "children": [
                        {
                            "name": "Flujo Cl치sico",
                            "description": "M칠todos tradicionales con limitaciones.",
                            "children": [
                                { "name": "venv", "description": "M칩dulo est치ndar para crear entornos virtuales." },
                                { "name": "pip", "description": "Instalador de paquetes est치ndar de Python." },
                                { "name": "requirements.txt", "description": "Archivo para listar dependencias. Fr치gil para reproducibilidad." }
                            ]
                        },
                        {
                            "name": "Gestores Modernos",
                            "description": "Herramientas 'todo en uno' basadas en pyproject.toml.",
                            "children": [
                                { "name": "Pipenv", "description": "Usa Pipfile y Pipfile.lock para builds deterministas." },
                                { "name": "Poetry", "description": "Gesti칩n completa: dependencias, empaquetado y publicaci칩n." },
                                { "name": "PDM", "description": "Enfocado en est치ndares (PEP 621) y flexibilidad." }
                            ]
                        },
                        {
                            "name": "Nueva Generaci칩n",
                            "description": "Enfoque en m치ximo rendimiento.",
                            "children": [
                                { "name": "uv", "description": "Instalador y resolvedor ultrarr치pido escrito en Rust." }
                            ]
                        },
                        {
                            "name": "Scripts Aut칩nomos",
                            "description": "Para herramientas de un solo archivo.",
                            "children": [
                                { "name": "PEP 723", "description": "Est치ndar para embeber dependencias en scripts. Usado por 'uv run'." }
                            ]
                        }
                    ]
                },
                {
                    "name": "Empaquetado y Distribuci칩n",
                    "description": "Compartir el c칩digo como bibliotecas o aplicaciones.",
                    "children": [
                        {
                            "name": "Estrategia",
                            "description": "La diferencia clave entre biblioteca y aplicaci칩n.",
                            "children": [
                                { "name": "Biblioteca", "description": "Dependencias flexibles (ej. >=1.0, <2.0). Para ser usada por otros." },
                                { "name": "Aplicaci칩n", "description": "Dependencias fijas (==1.1.5). Para el usuario final." }
                            ]
                        },
                        {
                            "name": "Formatos",
                            "description": "Archivos generados para la distribuci칩n.",
                            "children": [
                                { "name": "sdist (Source)", "description": "C칩digo fuente. Requiere compilaci칩n en destino." },
                                { "name": "Wheel (Binary)", "description": "Pre-compilado. Instalaci칩n r치pida y sin dependencias de compilaci칩n." }
                            ]
                        },
                        {
                            "name": "Distribuci칩n de Apps",
                            "description": "Empaquetar para usuarios no t칠cnicos.",
                            "children": [
                                { "name": "PyInstaller", "description": "Crea ejecutables aut칩nomos (.exe, .app)." },
                                { "name": "Docker", "description": "Crea contenedores para m치xima reproducibilidad en servidores." }
                            ]
                        }
                    ]
                }
            ]
        };

        // --- 2. D3.js SETUP ---
        const width = window.innerWidth;
        const height = window.innerHeight;
        let i = 0;
        const duration = 750;
        let root;

        // Setup SVG and zoom/pan behavior
        const svg = d3.select("#mindmap-container").append("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("viewBox", [-width / 2, -height / 2, width, height]);

        const g = svg.append("g");

        const zoom = d3.zoom()
            .scaleExtent([0.1, 3])
            .on("zoom", (event) => {
                g.attr("transform", event.transform);
            });

        svg.call(zoom);

        // Setup tooltip
        const tooltip = d3.select(".tooltip");

        // Color scale for different levels of the hierarchy
        const colorScale = d3.scaleOrdinal(d3.schemeCategory10);

        // Create tree layout
        const treemap = d3.tree().nodeSize([40, 200]);

        // --- 3. INITIAL RENDER AND UPDATE LOGIC ---
        root = d3.hierarchy(treeData, d => d.children);
        root.x0 = height / 2;
        root.y0 = 0;

        // Collapse all nodes except the root and its direct children
        root.children.forEach(collapse);

        update(root);
        centerNode(root);

        // --- 4. HELPER FUNCTIONS ---

        // Collapse the node and all its children
        function collapse(d) {
            if (d.children) {
                d._children = d.children;
                d._children.forEach(collapse);
                d.children = null;
            }
        }

        // Center the view on a given node
        function centerNode(source) {
            const t = d3.zoomTransform(svg.node());
            const x = -source.y0;
            const y = -source.x0;

            svg.transition().duration(duration).call(
                zoom.transform,
                d3.zoomIdentity.translate(width / 2, height / 2).scale(t.k).translate(x, y)
            );
        }

        // Main update function to redraw the tree
        function update(source) {
            const treeLayout = treemap(root);
            let nodes = treeLayout.descendants();
            let links = treeLayout.descendants().slice(1);

            const spacingFactor = document.getElementById('spacing').value || 1.5;
            nodes.forEach(d => { d.y = d.depth * 180 * spacingFactor; });

            // --- Nodes ---
            const node = g.selectAll('g.node')
                .data(nodes, d => d.id || (d.id = ++i));

            const nodeEnter = node.enter().append('g')
                .attr('class', 'node')
                .attr("transform", d => `translate(${source.y0},${source.x0})`)
                .on('click', click)
                .on('mouseover', (event, d) => {
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(`<strong>${d.data.name}</strong><br/>${d.data.description || ''}`)
                        .style("left", (event.pageX + 15) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on('mouseout', () => {
                    tooltip.transition().duration(500).style("opacity", 0);
                });

            nodeEnter.append('circle')
                .attr('r', 1e-6)
                .style("fill", d => d._children ? colorScale(d.depth) : '#fff');

            nodeEnter.append('text')
                .attr("dy", ".35em")
                .attr("x", d => d.children || d._children ? -18 : 18)
                .attr("text-anchor", d => d.children || d._children ? "end" : "start")
                .text(d => d.data.name);

            const nodeUpdate = nodeEnter.merge(node);

            nodeUpdate.transition()
                .duration(duration)
                .attr("transform", d => `translate(${d.y},${d.x})`);

            nodeUpdate.select('circle')
                .attr('r', 10)
                .style("fill", d => d._children ? colorScale(d.depth) : '#fff')
                .attr("stroke", d => colorScale(d.depth));

            const nodeExit = node.exit().transition()
                .duration(duration)
                .attr("transform", d => `translate(${source.y},${source.x})`)
                .remove();

            nodeExit.select('circle').attr('r', 1e-6);
            nodeExit.select('text').style('fill-opacity', 1e-6);

            // --- Links ---
            const link = g.selectAll('path.link')
                .data(links, d => d.id);

            const linkEnter = link.enter().insert('path', "g")
                .attr("class", "link")
                .attr('d', d => {
                    const o = { x: source.x0, y: source.y0 };
                    return diagonal(o, o);
                });

            const linkUpdate = linkEnter.merge(link);

            linkUpdate.transition()
                .duration(duration)
                .attr('d', d => diagonal(d, d.parent));

            const linkExit = link.exit().transition()
                .duration(duration)
                .attr('d', d => {
                    const o = { x: source.x, y: source.y };
                    return diagonal(o, o);
                })
                .remove();

            nodes.forEach(d => {
                d.x0 = d.x;
                d.y0 = d.y;
            });

            function diagonal(s, d) {
                return `M ${s.y} ${s.x}
                        C ${(s.y + d.y) / 2} ${s.x},
                          ${(s.y + d.y) / 2} ${d.x},
                          ${d.y} ${d.x}`;
            }

            // Toggle children on click.
            function click(event, d) {
                if (d.children) {
                    d._children = d.children;
                    d.children = null;
                } else {
                    d.children = d._children;
                    d._children = null;
                }
                update(d);
                centerNode(d);
            }
        }

        // --- 5. UI CONTROLS ---
        d3.select("#zoom_in").on("click", () => svg.transition().call(zoom.scaleBy, 1.2));
        d3.select("#zoom_out").on("click", () => svg.transition().call(zoom.scaleBy, 0.8));
        d3.select("#reset").on("click", () => {
            svg.transition().duration(750).call(
                zoom.transform,
                d3.zoomIdentity.translate(width / 2, height / 2).scale(1)
            );
            centerNode(root);
        });
        d3.select("#spacing").on("input", () => update(root));

        // Adjust SVG size on window resize
        window.addEventListener('resize', () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight;
            svg.attr("width", newWidth).attr("height", newHeight);
            svg.attr("viewBox", [-newWidth / 2, -newHeight / 2, newWidth, newHeight]);
        });

    </script>
</body>

</html>